bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(asymptote=2), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
sim.n <- 10^2
time = seq(-.5,5,.5)
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=.999, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.999, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.999, label="condition3")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
data.dprime
# data.nyes <- data.nyes[with(data.nyes, order(condition,signal, interval)),]
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
str(1:4)
sprintf("x %s x", str(1:4))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
res
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
sim.n <- 32*2
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=.95, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.95, label="condition2")
sim.n <- 32*2
time = seq(-.5,5,.5)
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=.95, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.95, label="condition2")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
data.dprime
sim.n <- 32*2
time = seq(-.5,5,.5)
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=.95, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.95, label="condition2")
data <- rbind(data1, data2)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
data.dprime
# data.nyes <- data.nyes[with(data.nyes, order(condition,signal, interval)),]
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
source("~/CodeSATF/test/satf_load.R")
source("~/CodeSATF/test/satf_load.R")
(m.nyes1 <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
sim.n <- 32*2
time = seq(-.5,5,.5)
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=.95, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.95, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=.95, label="condition3")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
data.dprime
# data.nyes <- data.nyes[with(data.nyes, order(condition,signal, interval)),]
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
sim.n <- 32*2
time = seq(-.5,5,.5); rho = .85;
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=rho, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition3")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
nrow(data)
length(seq(-.5,5,.5))
seq(-.2,5,.4)
length(seq(-.2,5,.4))
seq(-.2,4.6,.4)
length(seq(-.2,5,.4))
length(seq(-.2,4.6,.4))
fn.bias <- function(t) t*0 # SATF(t, asymptote=1, invrate=1, intercept=.4)
fn.satf1 <- function(t) SATF(t, asymptote=3, invrate=1, intercept=.4)
fn.satf2 <- function(t) SATF(t, asymptote=2, invrate=.5, intercept=0)
sim.n <- 32*2
time = seq(-.2,4.6,.4); rho = .85;
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=rho, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition3")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
# data.nyes <- data.nyes[with(data.nyes, order(condition,signal, interval)),]
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
nrow(data)
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, data=data.nyes, metric="logLik", debug=T))
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
source('~/CodeSATF/R/satf.R')
(m.nyes <- satf(dv=c(n.responses.yes=~n.responses.yes, n.responses=~n.responses), signal=~signal,
start     = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, data=subset(data.nyes, interval==12), metric="logLik", debug=T))
subset(data, trial.id==1)
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=subset(data, interval==12 & trial.id==1), metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1+c2+c3, constraints=list(), time=~time, trial.id=~trial.id,
data=subset(data, interval==12 & trial.id==1), metric="logLikRaw", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=subset(data, interval==12 & trial.id==1), metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=subset(data, interval==12 & trial.id==1), metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
fn.bias <- function(t) t*0 # SATF(t, asymptote=1, invrate=1, intercept=.4)
fn.satf1 <- function(t) SATF(t, asymptote=3, invrate=1, intercept=.4)
fn.satf2 <- function(t) SATF(t, asymptote=2, invrate=.5, intercept=0)
sim.n <- 32*2
time = seq(-.2,4.6,.4); rho = .85;
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=rho, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition3")
data <- rbind(data1, data2, data3)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
# data.nyes <- data.nyes[with(data.nyes, order(condition,signal, interval)),]
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes$c1 <- ifelse(data.nyes$condition=="condition1", 1, 0)
data.nyes$c2 <- ifelse(data.nyes$condition=="condition2", 1, 0)
data.nyes$c3 <- ifelse(data.nyes$condition=="condition3", 1, 0)
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
sum(m.raw)
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
sum(m.raw)
data$LL <- m.raw
with(subset(data, signal==0), tapply(LL, interval, mean))
with(subset(data, signal==0), tapply(LL, interval, min))
with(subset(data, signal==0), tapply(LL, interval, max))
logodds2p(-.63)
logodds2p(-.06)
data.tmp2 <- subset(data, signal==0)
head(data.tmp2)
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(bias.min=0, bias.max=0), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(bias.min=0, bias.max=0, bias.invrate=0, bias.intercept=0), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
data$LL <- m.raw
data.tmp2 <- subset(data, signal==0)
head(data.tmp2)
source('~/CodeSATF/R/satf.R')
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(bias.min=0, bias.max=0, bias.invrate=0, bias.intercept=0), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
(m.raw <- satf(dv=c(response=~response), signal=~signal, start = c(asymptote=2, invrate=1, intercept=.4, bias.min=0),
contrasts = c(asymptote=~1+c2+c3, invrate=~1+c2+c3, intercept=~1+c2+c3),
bias = ~1, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source("~/CodeSATF/test/satf_load.R")
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
pmin
pmax(1:10, 5)
source('~/CodeSATF/R/satf.R')
source('~/CodeSATF/R/satf.R')
setwd("~/CodeSATF/test")
source("~/CodeSATF/test/satf_load.R")
?sourceCpp
source("~/CodeSATF/test/satf_load.R")
fn.bias <- function(t) t*0 # SATF(t, asymptote=1, invrate=1, intercept=.4)
fn.satf1 <- function(t) SATF(t, asymptote=3, invrate=1, intercept=.4)
fn.satf2 <- function(t) SATF(t, asymptote=1, invrate=.5, intercept=.4)
sim.n <- 100
time = seq(-.2,4.6,.4); rho = .85;
data1 <- satf_generate(criterion=fn.bias, dprime=fn.satf1, time=time, n=sim.n, rho=rho, label="condition1")
data2 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition2")
data3 <- satf_generate(criterion=fn.bias, dprime=fn.satf2, time=time, n=sim.n, rho=rho, label="condition3")
data <- rbind(data1, data2, data3)
data$c1 <- ifelse(data$condition=="condition1", 1, 0)
data$c2 <- ifelse(data$condition=="condition2", 1, 0)
data$c3 <- ifelse(data$condition=="condition3", 1, 0)
data.nyes <- satf_aggregate_nyes(data, id=c('condition','interval'), time.id=c('interval'), signal='signal')
data.dprime <- satf_aggregate_dprime(data.nyes, id=c('condition', 'interval'), signal='signal',
dv=c('n.responses.yes', 'n.responses'))
ggplot(data.dprime, aes(x=time, y=dprime, color=condition))+geom_point()
ggplot(data.nyes, aes(x=time, y=n.responses.yes/n.responses, color=condition, linetype=as.factor(signal)))+geom_point()
data = subset(data, condition%in%c("condition1","condition2"))
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T, method="BHHH"))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T, method="BHHH"))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T, method="BHHH"))
})
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T, method="BHHH"))
})
source('~/CodeSATF/R/satf.R')
source("~/CodeSATF/test/satf_load.R")
system.time({
(m.raw <- satf(dv=c(response=~response), signal=~signal,
start = c(asymptote=2, invrate=1, intercept=.4, bias.max=1, bias.invrate=1, bias.intercept=-1, bias.min=0),
contrasts = c(asymptote=~1+c2, invrate=~1+c2, intercept=~1+c2),
bias = ~1+c2, constraints=list(), time=~time, trial.id=~trial.id,
data=data, metric="logLikRaw", debug=T, method="BHHH"))
})
